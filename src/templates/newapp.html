<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crossword Puzzle</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
    <div id="app">
        <div id="notmenu">
            <div class="clue-column">
                <ul id="across">
                    <li v-for="word in crossword" v-if="word.direction === 'across'">
                        <span @click="handle_clue_click($event,word)">[[ word.index ]]. [[ word.clue ]]</span>
                        <div class="state-container">
                            <span v-for="(char, index) in getCurrentAnswer(word)" 
                                  :key="index"
                                  class="state"
                                  :class="{
                                      'red': isChecking && char.toLowerCase() !== word.answer[index].toLowerCase() && char !== ' ',
                                      'green': isChecking && char.toLowerCase() === word.answer[index].toLowerCase() && char !== ' '
                                  }">[[char]]</span>
                        </div>
                    </li>
                </ul>
            </div>
            
            <div class="center-column">
                <div id="crossword-container">
                    <div class="grid" :style="{
                        'grid-template-rows': `repeat(${grid.length}, var(--cell-size))`
                    }">
                        <div class="grid-row" v-for="(row, rowIndex) in grid" :key="rowIndex" 
                             :style="{
                                 'grid-template-columns': `repeat(${row.length}, var(--cell-size))`
                             }">
                            <div v-for="(cell, cellIndex) in row" :key="cellIndex" 
                                 class="grid-cell"
                                 :class="{'black-cell': cell === null}">
                                <span class="clue-index" v-if="find_index(rowIndex, cellIndex)">[[find_index(rowIndex, cellIndex)]]</span>
                                <template v-if="cell !== null">
                                    <input ref="inputCells" 
                                           :ref="'input-' + rowIndex + '-' + cellIndex"
                                           type="text" 
                                           maxlength="1" 
                                           v-model="grid[rowIndex][cellIndex]"
                                           @keydown="handle_crossword_cell_keydown($event, rowIndex, cellIndex)"
                                           :data-row="rowIndex" 
                                           :data-cell="cellIndex"
                                           :data-solution="find_solution(rowIndex,cellIndex)"
                                           :aria-label="'grid cell ' + rowIndex + '-' + cellIndex">
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="menu">
                    <button id="load" onclick="load_crossword()">Load Crossword</button>
                    <button id="sample" onclick="load_sample_crossword()">Sample</button>
                    <button @click="check_all()" id="check-all">Check all</button>
                    <button id="monday" onclick="load_weekday(1)">Monday</button>
                    <button id="tuesday" onclick="load_weekday(2)">tuesday</button>
                    <button id="wednesday" onclick="load_weekday(3)">Wednesday</button>
                    <button @click="toggle_night_mode()" id="toggle-night-mode">Toggle Night Mode</button>
                </div>
            </div>
            
            <div class="clue-column">
                <ul id="down">
                    <li v-for="word in crossword" :key="word" v-if="word.direction ==='down'">
                        <span @click="handle_clue_click($event,word)">[[ word.index ]]. [[ word.clue ]]</span>
                        <div class="state-container">
                            <span v-for="(char, index) in getCurrentAnswer(word)" 
                                  :key="index"
                                  class="state"
                                  :class="{
                                      'red': isChecking && char.toLowerCase() !== word.answer[index].toLowerCase() && char !== ' ',
                                      'green': isChecking && char.toLowerCase() === word.answer[index].toLowerCase() && char !== ' '
                                  }">[[char]]</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>

</html>